CREATE TABLE ayuda (ayu_codigo INT, ayu_nombre TEXT, ayu_penalizacion NUMERIC(18,2), ayu_cuerpo TEXT, PRIMARY KEY(ayu_codigo));
CREATE TABLE curso (cur_codigo INT, cur_nombre TEXT, PRIMARY KEY(cur_codigo));
CREATE TABLE dispositivo (dis_codigo INT, nombre TEXT, PRIMARY KEY(dis_codigo));
CREATE TABLE estudiante (est_codigo_usuario INT, est_codigo_identificacion INT NOT NULL, est_codigo INT, est_nombres TEXT, est_apellidos TEXT, est_telefono TEXT, est_e_mail TEXT, est_habilitado TEXT, est_url_imagen TEXT, pre_identificacion TEXT, PRIMARY KEY(est_codigo));
CREATE TABLE estudiante_curso (est_cur_codigo_curso INT, est_cur_codigo_estudiante INT, PRIMARY KEY(est_cur_codigo_curso, est_cur_codigo_estudiante));
CREATE TABLE estudiante_evaluacion_grupo (id BIGSERIAL, est_eva_gru_codigo_estudiante INT, est_eva_gru_codigo_evaluacion INT, est_eva_gru_numero_grupo INT, PRIMARY KEY(id));
CREATE TABLE estudiante_solucion_evaluacion (id BIGSERIAL, codigo_estudiante INT, codigo_pregunta INT, codigo_evaluacion INT, codigo_ayuda INT, PRIMARY KEY(id));
CREATE TABLE estudiante_solucion_evaluacion_ayuda (codigo_estudiante INT, codigo_pregunta INT, codigo_evaluacion INT, PRIMARY KEY(codigo_estudiante, codigo_pregunta, codigo_evaluacion));
CREATE TABLE estudiante_solucion_evaluacion_pregunta (est_sol_eva_pre_codigo_estudiante INT, est_sol_eva_pre_codigo_pregunta INT, est_sol_eva_pre_codigo_evaluacion INT, PRIMARY KEY(est_sol_eva_pre_codigo_estudiante, est_sol_eva_pre_codigo_pregunta, est_sol_eva_pre_codigo_evaluacion));
CREATE TABLE estudiante_solucion_evaluacion_pregunta_ayuda (id BIGSERIAL, est_sol_eva_pre_ayu_codigo_estudiante INT, est_sol_eva_pre_ayu_codigo_pregunta INT, est_sol_eva_pre_ayu_codigo_evaluacion INT, est_sol_eva_pre_ayu_codigo_ayuda INT, PRIMARY KEY(id));
CREATE TABLE estudiante_solucion_evaluacion_pregunta_dispositivo (id BIGSERIAL, est_sol_eva_pre_dis_codigo_estudiante INT, est_sol_eva_pre_dis_codigo_pregunta INT, est_sol_eva_pre_dis_codigo_evaluacion INT, est_sol_eva_pre_dis_codigo_dispositivo INT, PRIMARY KEY(id));
CREATE TABLE evaluacion (eva_codigo INT, eva_codigo_profesor INT NOT NULL, eva_codigo_tema_materia INT, eva_nombre TEXT, eva_hora_inicio TIME, eva_hora_fin TIME, eva_numero_personas_grupo INT, eva_publico BOOLEAN, eva_fecha DATE, eva_numero_intentos INT, eva_mostrar_solucion BOOLEAN, eva_barajar_preguntas BOOLEAN, PRIMARY KEY(eva_codigo));
CREATE TABLE evaluacion_pregunta (eva_pre_codigo_evaluacion INT, eva_pre_codigo_pregunta INT, PRIMARY KEY(eva_pre_codigo_evaluacion, eva_pre_codigo_pregunta));
CREATE TABLE evaluacion_pregunta_ayuda (id BIGSERIAL, eva_pre_ayu_codigo_evaluacion INT, eva_pre_ayu_codigo_pregunta INT, eva_pre_ayu_codigo_ayuda INT, PRIMARY KEY(id));
CREATE TABLE herramienta (her_codigo INT, her_nombre TEXT, PRIMARY KEY(her_codigo));
CREATE TABLE identificacion (ide_codigo INT, ide_tipo TEXT, PRIMARY KEY(ide_codigo));
CREATE TABLE pregunta (pre_codigo INT, pre_codigo_profesor INT NOT NULL, pre_codigo_tema_o_materia INT, pre_codigo_tipo_pregunta INT, pre_cuerpo TEXT, pre_solucion TEXT, pre_publico BOOLEAN, PRIMARY KEY(pre_codigo));
CREATE TABLE pregunta_herramienta (id BIGSERIAL, pre_her_codigo_herramienta INT NOT NULL, pre_her_codigo_pregunta INT NOT NULL, PRIMARY KEY(id));
CREATE TABLE profesor (pro_codigo INT, pro_codigo_usuario INT, pro_codigo_identificacion INT NOT NULL, pro_nombres TEXT, pro_apellidos TEXT, pro_telefono TEXT, pro_e_mail TEXT, pro_habilitado BOOLEAN, pro_url_imagen TEXT, pro_identificacion TEXT, PRIMARY KEY(pro_codigo));
CREATE TABLE tema_o_materia (tom_codigo INT, tom_nombre TEXT, PRIMARY KEY(tom_codigo));
CREATE TABLE tipo_pregunta (tip_pre_codigo INT, tip_pre_nombre TEXT, tip_pre_plantilla TEXT, PRIMARY KEY(tip_pre_codigo));
CREATE TABLE usuario (usu_codigo INT, usu_login TEXT, usu_password TEXT, PRIMARY KEY(usu_codigo));
CREATE SEQUENCE ayuda_ayu_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE dispositivo_dis_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE estudiante_est_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE evaluacion_eva_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE herramienta_her_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE identificacion_ide_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE pregunta_pre_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE profesor_pro_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE tema_o_materia_tom_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE tipo_pregunta_tip_pre_codigo_seq INCREMENT 1 START 1;
CREATE SEQUENCE usuario_usu_codigo_seq INCREMENT 1 START 1;
ALTER TABLE estudiante ADD CONSTRAINT estudiante_est_codigo_usuario_usuario_usu_codigo FOREIGN KEY (est_codigo_usuario) REFERENCES usuario(usu_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante ADD CONSTRAINT estudiante_est_codigo_identificacion_identificacion_ide_codigo FOREIGN KEY (est_codigo_identificacion) REFERENCES identificacion(ide_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_curso ADD CONSTRAINT estudiante_curso_est_cur_codigo_estudiante_estudiante_est_codigo FOREIGN KEY (est_cur_codigo_estudiante) REFERENCES estudiante(est_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_curso ADD CONSTRAINT estudiante_curso_est_cur_codigo_curso_curso_cur_codigo FOREIGN KEY (est_cur_codigo_curso) REFERENCES curso(cur_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_evaluacion_grupo ADD CONSTRAINT eeee_3 FOREIGN KEY (est_eva_gru_codigo_estudiante) REFERENCES estudiante(est_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_evaluacion_grupo ADD CONSTRAINT eeee_2 FOREIGN KEY (est_eva_gru_codigo_evaluacion) REFERENCES evaluacion(eva_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_solucion_evaluacion ADD CONSTRAINT estudiante_solucion_evaluacion_codigo_ayuda_ayuda_codigo FOREIGN KEY (codigo_ayuda) REFERENCES ayuda(codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_solucion_evaluacion_ayuda ADD CONSTRAINT ecec FOREIGN KEY (codigo_estudiante) REFERENCES estudiante(codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_solucion_evaluacion_pregunta ADD CONSTRAINT eeee_4 FOREIGN KEY (est_sol_eva_pre_codigo_estudiante) REFERENCES estudiante(est_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_solucion_evaluacion_pregunta_ayuda ADD CONSTRAINT eeaa FOREIGN KEY (est_sol_eva_pre_ayu_codigo_ayuda) REFERENCES ayuda(ayu_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE estudiante_solucion_evaluacion_pregunta_dispositivo ADD CONSTRAINT eedd FOREIGN KEY (est_sol_eva_pre_dis_codigo_dispositivo) REFERENCES dispositivo(dis_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE evaluacion ADD CONSTRAINT evaluacion_eva_codigo_tema_materia_tema_o_materia_tom_codigo FOREIGN KEY (eva_codigo_tema_materia) REFERENCES tema_o_materia(tom_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE evaluacion ADD CONSTRAINT evaluacion_eva_codigo_profesor_profesor_pro_codigo FOREIGN KEY (eva_codigo_profesor) REFERENCES profesor(pro_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE evaluacion_pregunta ADD CONSTRAINT evaluacion_pregunta_eva_pre_codigo_pregunta_pregunta_pre_codigo FOREIGN KEY (eva_pre_codigo_pregunta) REFERENCES pregunta(pre_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE evaluacion_pregunta ADD CONSTRAINT eeee_7 FOREIGN KEY (eva_pre_codigo_evaluacion) REFERENCES evaluacion(eva_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE evaluacion_pregunta_ayuda ADD CONSTRAINT eeaa_1 FOREIGN KEY (eva_pre_ayu_codigo_ayuda) REFERENCES ayuda(ayu_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE pregunta ADD CONSTRAINT pregunta_pre_codigo_tipo_pregunta_tipo_pregunta_tip_pre_codigo FOREIGN KEY (pre_codigo_tipo_pregunta) REFERENCES tipo_pregunta(tip_pre_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE pregunta ADD CONSTRAINT pregunta_pre_codigo_tema_o_materia_tema_o_materia_tom_codigo FOREIGN KEY (pre_codigo_tema_o_materia) REFERENCES tema_o_materia(tom_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE pregunta ADD CONSTRAINT pregunta_pre_codigo_profesor_profesor_pro_codigo FOREIGN KEY (pre_codigo_profesor) REFERENCES profesor(pro_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE pregunta_herramienta ADD CONSTRAINT pregunta_herramienta_pre_her_codigo_pregunta_pregunta_pre_codigo FOREIGN KEY (pre_her_codigo_pregunta) REFERENCES pregunta(pre_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE pregunta_herramienta ADD CONSTRAINT pphh FOREIGN KEY (pre_her_codigo_herramienta) REFERENCES herramienta(her_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE profesor ADD CONSTRAINT profesor_pro_codigo_usuario_usuario_usu_codigo FOREIGN KEY (pro_codigo_usuario) REFERENCES usuario(usu_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE profesor ADD CONSTRAINT profesor_pro_codigo_identificacion_identificacion_ide_codigo FOREIGN KEY (pro_codigo_identificacion) REFERENCES identificacion(ide_codigo) NOT DEFERRABLE INITIALLY IMMEDIATE;
